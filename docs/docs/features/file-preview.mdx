---
title: 文件预览
description: OpenCowork 内置的文件预览系统。
---

# 文件预览 / File Preview

OpenCowork 内置文件预览系统，Agent 可以通过 `Preview` 工具在侧边栏展示文件内容。

## 支持的格式 / Supported Formats

| 格式 | 查看器 |
|------|--------|
| `.xlsx`, `.xls`, `.csv` | 电子表格查看器 |
| `.pdf` | PDF 查看器 |
| `.png`, `.jpg`, `.gif`, `.webp` | 图片查看器 |
| `.md`, `.mdx` | Markdown 渲染器 |
| `.docx` | Word 文档查看器 |

## 查看器注册 / Viewer Registry

查看器通过注册表模式管理，在应用启动时注册：

```typescript
// src/renderer/src/lib/preview/register-viewers.ts
registerViewer({
  name: 'spreadsheet',
  extensions: ['.xlsx', '.xls', '.csv'],
  component: SpreadsheetViewer,
});
```

## Preview 工具 / Preview Tool

Agent 通过 `Preview` 工具触发预览：

```json
{
  "path": "/path/to/report.xlsx",
  "title": "销售报告"
}
```

预览面板会在聊天界面右侧展开，不影响对话流程。

## Mermaid 图表 / Mermaid Diagrams

聊天消息中的 Mermaid 代码块会自动渲染为图表：

````
```mermaid
flowchart TD
    A[开始] --> B[处理]
    B --> C[结束]
```
````
